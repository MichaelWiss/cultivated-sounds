<section id="MainProduct-{{ section.id }}" class="bg-vinyl-paper min-h-screen" data-section="{{ section.id }}">
  
  <!-- Breadcrumb / Back -->
  <div class="border-b border-vinyl-blue px-4 sm:px-8 py-4 flex items-center justify-between sticky top-[64px] sm:top-[80px] z-30 bg-vinyl-paper/95 backdrop-blur-sm">
    <a href="{{ routes.all_products_collection_url }}" class="flex items-center gap-2 font-mono text-xs uppercase tracking-widest text-vinyl-blue hover:underline decoration-vinyl-blue underline-offset-4">
        ‚Üê Back to Shop
    </a>
    <div class="hidden sm:flex gap-4 font-mono text-xs text-gray-400 uppercase">
         {%- if product.metafields.custom.catalog_number -%}
           <span>Catalog #{{ product.metafields.custom.catalog_number }}</span>
           <span>/</span>
         {%- endif -%}
         <span>{{ product.vendor }}</span>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-12 min-h-[calc(100vh-140px)]">
    
    <!-- Left Column: Media (Sticky) -->
    <div class="lg:col-span-7 border-b lg:border-b-0 lg:border-r border-vinyl-blue relative">
        <div class="lg:sticky lg:top-[140px] h-auto lg:h-[calc(100vh-140px)] overflow-hidden flex flex-col">
            {% render 'product-media', product: product %}
        </div>
    </div>

    <!-- Right Column: Details (Scrollable) -->
    <div class="lg:col-span-5 bg-vinyl-paper">
        <div class="p-6 sm:p-10 lg:p-12 flex flex-col gap-8">
            
            <div id="ProductInfo-{{ section.id }}" class="product__info-container">
              {%- assign product_form_id = 'product-form-' | append: section.id -%}

              {%- for block in section.blocks -%}
                {%- case block.type -%}
                  {%- when '@app' -%}
                    {% render block %}
                  
                  {%- when 'text' -%}
                    <p class="product__text font-mono text-xs uppercase tracking-widest text-gray-500 mb-2" {{ block.shopify_attributes }}>
                      {{ block.settings.text }}
                    </p>
                  
                  {%- when 'title' -%}
                    <h1 class="font-serif text-4xl sm:text-5xl lg:text-6xl text-vinyl-blue leading-[0.9] mb-4" {{ block.shopify_attributes }}>
                      {{ product.title | escape }}
                    </h1>
                  
                  {%- when 'price' -%}
                    <div class="no-js-hidden mb-6" id="price-{{ section.id }}" role="status" {{ block.shopify_attributes }}>
                      {% render 'price', product: product, use_variant: true, show_badges: true, price_class: 'text-2xl font-mono' %}
                    </div>
                  
                  {%- when 'description' -%}
                    {%- if product.description != blank -%}
                      <div class="prose prose-sm font-sans text-gray-600 leading-relaxed max-w-none mb-8" {{ block.shopify_attributes }}>
                        {{ product.description }}
                      </div>
                    {%- endif -%}
                  
                  {%- when 'variant_picker' -%}
                    {%- unless product.has_only_default_variant -%}
                      <variant-radios
                        class="no-js-hidden mb-8 block"
                        data-section="{{ section.id }}"
                        data-url="{{ product.url }}"
                        {{ block.shopify_attributes }}
                      >
                        {%- for option in product.options_with_values -%}
                          <fieldset class="js product-form__input mb-4">
                            <legend class="form__label font-mono text-xs uppercase tracking-wide mb-3 text-gray-500">{{ option.name }}</legend>
                            <div class="flex flex-wrap gap-2">
                              {%- for value in option.values -%}
                                <input
                                  type="radio"
                                  id="{{ section.id }}-{{ option.position }}-{{ forloop.index0 }}"
                                  name="{{ option.name }}"
                                  value="{{ value | escape }}"
                                  form="{{ product_form_id }}"
                                  {% if option.selected_value == value %}
                                    checked
                                  {% endif %}
                                  class="sr-only peer"
                                >
                                <label 
                                  for="{{ section.id }}-{{ option.position }}-{{ forloop.index0 }}"
                                  class="cursor-pointer px-4 py-2 border border-vinyl-blue rounded-full font-mono text-xs uppercase tracking-wide peer-checked:bg-vinyl-blue peer-checked:text-white hover:bg-vinyl-blue/10 transition-colors"
                                >
                                  {{ value }}
                                </label>
                              {%- endfor -%}
                            </div>
                          </fieldset>
                        {%- endfor -%}
                        <script type="application/json">
                          {{ product.variants | json }}
                        </script>
                      </variant-radios>
                    {%- endunless -%}

                  {%- when 'quantity_selector' -%}
                    <div class="product-form__input product-form__quantity mb-8" {{ block.shopify_attributes }}>
                      <label class="form__label font-mono text-xs uppercase tracking-wide mb-3 block text-gray-500" for="Quantity-{{ section.id }}">
                        {{ 'products.product.quantity.label' | t }}
                      </label>
                      <quantity-input class="quantity flex items-center border border-vinyl-blue w-32 rounded-full overflow-hidden">
                        <button class="quantity__button no-js-hidden w-10 h-10 flex items-center justify-center text-vinyl-blue hover:bg-vinyl-blue hover:text-white transition-colors" name="minus" type="button">
                          <span class="visually-hidden">{{ 'products.product.quantity.decrease' | t: product: product.title | escape }}</span>
                          &minus;
                        </button>
                        <input
                          class="quantity__input flex-1 text-center border-none p-0 font-mono text-sm bg-transparent focus:ring-0"
                          type="number"
                          name="quantity"
                          id="Quantity-{{ section.id }}"
                          min="1"
                          value="1"
                          form="{{ product_form_id }}"
                        >
                        <button class="quantity__button no-js-hidden w-10 h-10 flex items-center justify-center text-vinyl-blue hover:bg-vinyl-blue hover:text-white transition-colors" name="plus" type="button">
                          <span class="visually-hidden">{{ 'products.product.quantity.increase' | t: product: product.title | escape }}</span>
                          &plus;
                        </button>
                      </quantity-input>
                    </div>

                  {%- when 'buy_buttons' -%}
                    {% render 'buy-buttons', block: block, product: product, product_form_id: product_form_id, section_id: section.id %}
                {%- endcase -%}
              {%- endfor -%}
            </div>

        </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Product Information",
  "tag": "section",
  "class": "section",
  "blocks": [
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "default": "Text block",
          "label": "Text"
        }
      ]
    },
    {
      "type": "title",
      "name": "Title",
      "limit": 1
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1
    },
    {
      "type": "quantity_selector",
      "name": "Quantity selector",
      "limit": 1
    },
    {
      "type": "variant_picker",
      "name": "Variant picker",
      "limit": 1
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "limit": 1
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1
    }
  ],
  "settings": []
}
{% endschema %}
