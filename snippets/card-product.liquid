{% comment %}
  Card Product Snippet
  - Ported from ProductCard.tsx
  - Uses Tailwind CSS
{% endcomment %}

{% comment %}
  Refined Product Card Snippet
{% endcomment %}

{%- assign product = card_product | default: product -%}

<div class="group relative flex flex-col h-full bg-transparent transition-all duration-300 cursor-pointer {{ class }}">
  <a href="{{ product.url }}" class="absolute inset-0 z-10">
    <span class="sr-only">View {{ product.title }}</span>
  </a>

  {% comment %} Image Container {% endcomment %}
  <div class="relative aspect-square w-full overflow-hidden mb-6">
    {% if product.featured_media %}
      <img 
        src="{{ product.featured_media | image_url: width: 800 }}" 
        alt="{{ product.featured_media.alt | escape }}" 
        width="{{ product.featured_media.width }}"
        height="{{ product.featured_media.height }}"
        loading="lazy"
        class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-700 ease-in-out"
      />
    {% else %}
      {{ 'product-1' | placeholder_svg_tag: 'w-full h-full object-cover grayscale' }}
    {% endif %}

    {% comment %} Badges {% endcomment %}
    <div class="absolute top-2 left-2 flex flex-col gap-2 z-20">
      {% unless product.available %}
        <div class="bg-black text-white text-[9px] font-mono uppercase px-2 py-0.5 tracking-[0.2em]">
          Sold Out
        </div>
      {% endunless %}
      {% if product.tags contains 'New' or product.tags contains 'new' %}
        <div class="bg-vinyl-blue text-white text-[9px] font-mono uppercase px-3 py-1 tracking-[0.2em] rounded-full">
          New
        </div>
      {% endif %}
    </div>
  </div>

  {% comment %} Details {% endcomment %}
  <div class="flex flex-col flex-1">
    <div class="flex flex-col gap-1 tracking-tight">
        <span class="font-sans text-[11px] font-bold uppercase text-vinyl-black leading-tight border-b border-transparent group-hover:text-vinyl-blue transition-colors">
            {{ product.vendor }} â€”
        </span>
        <h3 class="font-serif italic text-base text-vinyl-blue leading-tight truncate">
            {{ product.title }}
        </h3>
        <div class="mt-2 text-vinyl-black">
          <span class="font-mono text-[10px] font-bold">{{ product.price | money }}</span>
        </div>
    </div>
  </div>
</div>